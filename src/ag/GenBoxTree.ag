
-- Generating the Box-Tree Formatting Structure
ATTR WindowRoot WindowTree Line [|| outbox: {FSBox}]
SEM WindowTree
    | WindowItemContainer
        lhs.outbox = FSBox "item" @props @elem.outbox
    | WindowContainer
        lhs.outbox = case @loc.vdisplay of
                        "block"
                            -> case @fcnxt of
                                "block"  -> FSBox "box b b" @props @elem.outbox
                                "inline" -> FSBox "box b i" @props @elem.outbox
                        "inline"
                            -> case @fcnxt of
                                "block"  -> FSBox "box i b" @props @elem.outbox
                                "inline" -> FSBox "box i i" @props @elem.outbox
    | WindowText
        lhs.outbox = case @loc.vdisplay of
                        "block"  -> FSBox "text b i" @props []
                        "inline" -> FSBox "text i i" @props []

SEM Line
    | Line lhs.outbox = FSBox "line" Map.empty @winds.outbox

ATTR WindowTrees Lines Element [|| outbox USE {:} {[]}: {[FSBox]}]

SEM Element
    | EWinds   lhs.outbox = @winds.outbox
    | ELines   lhs.outbox = @lines.outbox
    | ENothing lhs.outbox = []


